# 네트워킹

## 네트워킹

### 네트워킹이란?

- 두 대 이상의 컴퓨터를 연결하여 네트워크를 구성하는 것
- 데이터 전달 및 주변기기(프린터) 공유 목적
- java.net 패키지를 이용하여 네트워크 어플리케이션 작성 가능

### 클라이언트와 서버

- 서버: 서비스를 제공하는 컴퓨터
- 클라이언트: 서비스를 이용하는 컴퓨터
- 서버 기반 모델
    - 네트워크 전용 서버를 구성
    - 안정적인 서비스 제공
    - 공유 데이터 관리 및 보안 용이
    - 비싼 서버 구축 비용, 관리 비용
- P2P 모델
    - 서버 구축 및 운용비용 절감
    - 자원 활용 극대화
    - 자원 관리의 어려움
    - 보안에 취약

### IP 주소

- 컴퓨터를 구뱔하는데 사용되는 고유한 값
- 4바이트 정수로 구성 - 바이트 단위로 점 찍어서 표현
- 서브넷 마스크를 & 연산하여 네트워크 주소만 뽑아낼 수 있음

### InetAddress

- IP주소를 다루기 위한 클래스
- getByName, getAllByName, getByAddress 또는 getLocalhost로 IP 주소 얻어옴
- hostName, hostAddress를 알 수 있음

### URL(Uniform Resource Locator)

- 인터넷에 존재하는 서버에서 제공하는 자원에 접근할 수 있는 주소를 표현
- 프로토콜://호스트명:포트번호/경로명/파일명?쿼리스트링#참조
- 포트번호(프로토콜의 기본 포트가 사용됨), 쿼리, 참조는 생략 가능
- URL 클래스를 이용하여 호스트명, 포트, Content객체, 파일명, 경로명, 프로토콜, 쿼리, 참조, 사용자 정보 등 조회 가능
- openConnection()을 통해 URLConnection 획득

### URLConnection

- 어플리케이션과 URL간의 통신 연결을 나타내는 최상위 추상클래스
- 구현한 클래스로 HttpURLConnection, JarURLConnection이 있음
- 연결하려는 자원에 접근하고 읽기와 쓰기 가능, 관련 정보 읽기와 쓰기 가능

## 소켓 프로그래밍

- 소켓은 프로세스간 통신에 사용되는 양쪽 엔드포인트(끝단)을 의미
- java.net 패키지에서 소켓 프로그래밍을 지원

### TCP와 UDP

|        | TCP                                                   | UDP                                             |
|--------|-------------------------------------------------------|-------------------------------------------------|
| 연결 방식  | 연결 기반<br/>1:1 통신 방식                                   | 비연결 기반<br/>1:1, 1:n, n:n 통신 방식                  |
| 특징     | 바이트스트림(데이터 경계를 구분하지 않음)<br/>신뢰성 있는 데이터 전송<br/>전송속도 느림 | 데이터그램(데이터 경계를 구분)<br/>신뢰성 없는 데이터 전송<br/>전송속도 빠름 |
| 관련 클래스 | Socket, ServerSocket                                  | DatagramSocket, DatagramPacket, MulticastSocket |
| 사용     | 파일 전송                                                 | 게임, 동영상                                         |

- 신뢰성 있는 데이터 전송
    - 데이터 전송 순서 보장
    - 데이터 수신 여부 확인(데이터 손실시 재전송)
    - 패킷을 관리할 필요가 없음

### TCP 소켓 프로그래밍

- 클라이언트-서버 간의 1:1 통신
- 통신 과정

1. 서버 프로그램에서 서버 소켓을 사용해서 서버 컴퓨터의 특정 포트에서 클라리언트의 연결 요청을 처리할 준비
2. 클라이언트 프로그램은 접속할 서버의 IP주소와 포트 정보를 이용하여 소켓을 생성항 서버에 연결 요청
3. 서버 소켓은 클라이언트의 요청을 받으면 서버에 새로운 소켓을 생성하여 클라이언트의 소켓과 연결
4. 클라이언트의 소켓과 서버의 새로 생성된 소켓은 서버 소켓과 관계없이 일대일 통신

- 서버 소켓은 포트와 결합되어 사용자의 연결 요청 대기하다가 연결 요청이 오면 새로운 소켓을 생성하여 클라이언트의 소켓과 통신할 수 있도록 연결하는 역할
    - 따라서 실질적인 통신은 클라이언트 소켓과 새로 생성된 소켓 간에 통신
- 같은 프로토콜을 사용하는 서버 소켓은 포트를 독점
- 소켓은 입력 스트림과 출력 스트림이 있으며 상대 소켓의 스트림과 교차 연결
- Socket 클래스: 프로세스 간의 통신, InputStream, OutputStream을 통해 프로세스간 통신이 이루어짐
- ServerSocket 클래스: 포트와 연결되어 외부 연결 요청 대기, 연결 요청시 소켓을 생성해서 소켓간 통신 이루어짐, 한 포트에 한 서버소켓만 연결 가능

### UDP 소켓 프로그래밍

- 서버 소켓 불필요
- 소켓은 DatagramSocket 데이터는 DatagramPacket에 담아서 전송
    - DatagramPacket은 헤더와 데이터로 구성
    - 헤더에는 패킷을 수신할 호스트 주소와 포트 정보가 저장되어 있음
    - 패킷에 지정된 주소의 소켓(DatagramSocket)에 도착